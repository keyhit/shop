<div class="side_nav">
  <div class="categories">
  <h3>Categories</h3>
    <% @categories.each do |category| %>
      <span >
        <%= link_to category.name, "#",
          class: "category" %>
      </span>
    <% end %>
      <div id="more"></div>
      <div id="more_categories"></div>
      <span class="category" id="show_more_categories">
        <%= link_to "More categories", "#",remote: true%>
      </span>

      <span class="category" id="hide_more_categories" style="display: none">
        <%= link_to "Less categories", "#",remote: true%>
      </span>

      </span>
  </div>
</div>

<div class="product_preview">
    <h3>Products</h3>
    <div class="products_block">
    <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>
      <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>
      <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>
      <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>
      <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>

    <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>
      <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>
      <div class="product">
      <h6>sdfsdf</h6>
      <%= image_tag 'logo', class: "img", alt: "e-shop logo"%>
    </div>

    <div class="product">
      sdfdsf
    </div>
    </div>
</div>
<script type="text/javascript">
  // var offset = 0
    $('#hide_more_categories').hide()

  $('#show_more_categories').click(function(){
      $('#show_more_categories').hide()
      $('#hide_more_categories').show()
      $('<div id="more_categories"></div>').appendTo("#more");

      // offset += 2
      var offset = 0
      offset += <%= @categories.count %>
      limit = <%= @categories_count %> - offset
      console.log("offset" + offset)
      console.log("limit" + limit)
    $.ajax({
      dataType: "json",
      url: 'http://localhost:3000//categories',
      data: { offset : offset, limit : limit } ,
    })
    .done(function( data ) {
      var span_begin = '<span>'
      var span_end = '</span>'
      $.each(data, function(key, value){
        $('#more_categories').append( span_begin 
          + "<a href='"
          + window.location.origin
          + "/categories/"+ value.id + "'class='category'>" 
          + value.name 
          + "</a>" 
          + span_end);
      })
    })
  });

  $('#hide_more_categories').click(function() {
    $(this).hide()
    $('#more_categories').remove()
    $('#show_more_categories').show()
  });
</script>


